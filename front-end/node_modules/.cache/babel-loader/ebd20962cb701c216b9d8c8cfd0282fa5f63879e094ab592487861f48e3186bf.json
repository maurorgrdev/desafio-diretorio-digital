{"ast":null,"code":"import { useUsuarioStore } from '../../store/user.js';\nexport default {\n  data: vm => ({\n    timeout: null,\n    login: '',\n    password: ''\n  }),\n  setup() {\n    const usuarioStore = useUsuarioStore();\n    return {\n      usuarioStore\n    };\n  },\n  methods: {\n    async validate() {\n      const valido = this.validaCnpj(this.login) || this.validaEmail(this.login);\n      console.log(this.login);\n      if (valido) {\n        const results = {\n          email: (await this.validaEmail(this.login)) ? this.login : '',\n          cnpj: (await this.validaCnpj(this.login)) ? this.login : '',\n          password: this.password\n        };\n        await this.submit(results);\n      } else {\n        alert('Login inválido');\n      }\n    },\n    async submit(results) {\n      const response = await this.usuarioStore.login(results);\n      await this.usuarioStore.loadUsuario();\n      if (response) {\n        await this.$router.replace({\n          path: '/fornecedores'\n        });\n      } else {}\n    },\n    async checkApi(userName) {\n      return new Promise(resolve => {\n        clearTimeout(this.timeout);\n        this.timeout = setTimeout(() => {\n          if (!userName) return resolve('Please enter a user name.');\n          if (userName === 'johnleider') return resolve('User name already taken. Please try another one.');\n          return resolve(true);\n        }, 1000);\n      });\n    },\n    validaCnpj(cnpj) {\n      cnpj = cnpj.replace(/[^\\d]+/g, '');\n      if (cnpj.length != 14) return false;\n      var tamanhoTotal = cnpj.length - 2;\n      var cnpjSemDigitos = cnpj.substring(0, tamanhoTotal);\n      var digitosVerificadores = cnpj.substring(tamanhoTotal);\n      var soma = 0;\n      var pos = tamanhoTotal - 7;\n      for (var i = tamanhoTotal; i >= 1; i--) {\n        soma += cnpjSemDigitos.charAt(tamanhoTotal - i) * pos--;\n        if (pos < 2) pos = 9;\n      }\n      var resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;\n      if (resultado != digitosVerificadores.charAt(0)) return false;\n      var tamanhoTotal = tamanhoTotal + 1;\n      var cnpjSemDigitos = cnpj.substring(0, tamanhoTotal);\n      var soma = 0;\n      var pos = tamanhoTotal - 7;\n      for (i = tamanhoTotal; i >= 1; i--) {\n        soma += cnpjSemDigitos.charAt(tamanhoTotal - i) * pos--;\n        if (pos < 2) pos = 9;\n      }\n      resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;\n      if (resultado != digitosVerificadores.charAt(1)) return false;\n      return true;\n    },\n    validaEmail(email) {\n      var re = /\\S+@\\S+\\.\\S+/;\n      return re.test(email);\n    }\n  }\n};","map":{"version":3,"names":["useUsuarioStore","data","vm","timeout","login","password","setup","usuarioStore","methods","validate","valido","validaCnpj","validaEmail","console","log","results","email","cnpj","submit","alert","response","loadUsuario","$router","replace","path","checkApi","userName","Promise","resolve","clearTimeout","setTimeout","length","tamanhoTotal","cnpjSemDigitos","substring","digitosVerificadores","soma","pos","i","charAt","resultado","re","test"],"sources":["/Users/mauroroger/Desktop/diretorio-digital/front-end-diretorio-digital/front-end/src/views/Usuario/Login.vue"],"sourcesContent":["<template>\n    <v-container>\n        <v-card \n            class=\"mx-auto\"\n            max-width=\"500\">\n            <v-card-item>\n                <v-form validate-on=\"submit lazy\" @submit.prevent=\"validate\">\n                    <v-row>\n                        <v-text-field\n                        v-model=\"login\"\n                        label=\"CPF ou Email\"\n                        ></v-text-field>\n                    </v-row>\n                    <v-row>\n                        <v-text-field\n                        v-model=\"password\"\n                        label=\"Password\"\n                        ></v-text-field>\n                    </v-row>\n                    <v-btn\n                    type=\"submit\"\n                    block\n                    class=\"mt-2\"\n                    text=\"Login\"\n                    ></v-btn>\n                </v-form>\n            </v-card-item>\n        </v-card>\n    </v-container>\n</template>\n\n<script>\n    import { useUsuarioStore } from '../../store/user.js'\n  export default {\n    data: vm => ({\n      timeout: null,\n      login: '',\n      password: '',\n    }),\n\n    setup() {\n        const usuarioStore = useUsuarioStore()\n\n        return { usuarioStore }\n    },\n\n    methods: {\n      async validate(){\n\n        const valido = this.validaCnpj(this.login) || this.validaEmail(this.login);\n\n        console.log(this.login);\n        if(valido){\n            const results = {\n                email: await this.validaEmail(this.login) ? this.login : '',\n                cnpj: await this.validaCnpj(this.login) ? this.login : '',\n                password: this.password\n            }\n\n            await this.submit(results);\n        }  else {\n            alert('Login inválido');\n        }\n\n        \n      },\n\n      async submit (results) {\n        const response = await this.usuarioStore.login(results);\n        \n        await this.usuarioStore.loadUsuario();\n\n        if(response){\n            await this.$router.replace({ path: '/fornecedores' })\n        } else {\n\n        }\n        \n      },\n      async checkApi (userName) {\n        return new Promise(resolve => {\n          clearTimeout(this.timeout)\n\n          this.timeout = setTimeout(() => {\n            if (!userName) return resolve('Please enter a user name.')\n            if (userName === 'johnleider') return resolve('User name already taken. Please try another one.')\n\n            return resolve(true)\n          }, 1000)\n        })\n      },\n\n        validaCnpj(cnpj) {\n            cnpj = cnpj.replace(/[^\\d]+/g, '');\n\n            if (cnpj.length != 14)\n                return false;\n\n            var tamanhoTotal = cnpj.length - 2\n            var cnpjSemDigitos = cnpj.substring(0, tamanhoTotal);\n            var digitosVerificadores = cnpj.substring(tamanhoTotal);\n            var soma = 0;\n            var pos = tamanhoTotal - 7;\n            for (var i = tamanhoTotal; i >= 1; i--) {\n                soma += cnpjSemDigitos.charAt(tamanhoTotal - i) * pos--;\n                if (pos < 2)\n                    pos = 9;\n            }\n            var resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;\n            if (resultado != digitosVerificadores.charAt(0))\n                return false;\n\n            var tamanhoTotal = tamanhoTotal + 1;\n            var cnpjSemDigitos = cnpj.substring(0, tamanhoTotal);\n            var soma = 0;\n            var pos = tamanhoTotal - 7;\n            for (i = tamanhoTotal; i >= 1; i--) {\n                soma += cnpjSemDigitos.charAt(tamanhoTotal - i) * pos--;\n                if (pos < 2)\n                    pos = 9;\n            }\n\n            resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;\n            if (resultado != digitosVerificadores.charAt(1))\n                return false;\n\n            return true;\n        },\n\n        validaEmail(email) {\n            var re = /\\S+@\\S+\\.\\S+/;\n            return re.test(email);\n        }\n    },\n  }\n</script>\n\n<!-- <script setup>\n\nimport { reactive } from 'vue'\nimport { useUsuarioStore } from \"../../store/user\"\n\nconst store = useUsuarioStore()\n\nlet login = ''\nlet password = ''\n\nconst nameRules = [\n    value => {\n        if (value) return true\n\n        return 'Name is required.'\n    },\n    value => {\n        if (value?.length <= 10) return true\n\n        return 'Name must be less than 10 characters.'\n    },\n]\nlet email = ''\nconst emailRules = [\n    value => {\n        if (value) return true\n\n        return 'E-mail is requred.'\n    },\n    value => {\n        if (/.+@.+\\..+/.test(value)) return true\n\n        return 'E-mail must be valid.'\n    },\n]\n\n\nfunction userLogin() {\n    const dados = reactive({\n        login: login,\n        password: password,\n    })  \n    \n    store.login(dados);\n}\n</script> -->"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}